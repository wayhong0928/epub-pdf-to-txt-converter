# 使用手冊

EPUB/PDF 轉 TXT 轉換器的完整使用指南。

## 目錄

1. [開始使用](#開始使用)
2. [介面概覽](#介面概覽)
3. [轉換流程](#轉換流程)
4. [進階功能](#進階功能)
5. [設定說明](#設定說明)
6. [疑難排解](#疑難排解)

## 開始使用

### 系統需求
- Windows 10/11、macOS 10.14+ 或 Linux (Ubuntu 18.04+)
- Python 3.7+（僅限原始碼安裝）
- 512MB 可用記憶體（最低需求）
- 50MB 可用磁碟空間

### 安裝選項

#### 選項一：執行檔（推薦）
1. 從 [GitHub Releases](https://github.com/wayhong0928/epub-pdf-to-txt-converter/releases) 下載
2. 解壓縮 ZIP 檔案到您希望的位置
3. 執行 `EPUB_PDF_to_TXT_Converter.exe`

#### 選項二：原始碼
1. 複製或下載儲存庫
2. 從 [python.org](https://python.org) 安裝 Python 3.7+
3. 安裝相依套件：`pip install -r requirements.txt`
4. 執行：`python main.py`

## 介面概覽

### 主視窗配置
```
┌─────────────────────────────────────────────────┐
│ 語言選擇：[English] [中文(繁體)]                │
├─────────────────────────────────────────────────┤
│ 檔案選擇                                        │
│ 輸入：  [路徑欄位]              [瀏覽]          │
│ 輸出：  [路徑欄位]              [瀏覽]          │
├─────────────────────────────────────────────────┤
│ 選項                                            │
│ □ 保留資料夾結構                                │
│ □ 跳過現有檔案                                  │
├─────────────────────────────────────────────────┤
│ 進度                                            │
│ [████████████████████████████████] 100%        │
│ 狀態：轉換成功完成                              │
├─────────────────────────────────────────────────┤
│ [轉換]  [清除]  [離開]                          │
├─────────────────────────────────────────────────┤
│ 狀態列：準備就緒                                │
└─────────────────────────────────────────────────┘
```

### 語言選擇
- **English**：設定介面為英文
- **中文(繁體)**：設定介面為繁體中文
- 變更會立即套用並自動儲存

### 檔案選擇
- **輸入**：選擇來源檔案或包含 EPUB/PDF 檔案的資料夾
- **輸出**：選擇轉換後 TXT 檔案的目標資料夾
- **瀏覽按鈕**：開啟檔案/資料夾選擇對話方塊

### 選項設定
- **保留資料夾結構**：維持原始目錄階層
- **跳過現有檔案**：避免重複處理已存在的檔案

### 進度區域
- **進度條**：視覺化顯示轉換進度
- **狀態文字**：當前操作的詳細資訊
- **即時更新**：顯示目前正在處理的檔案

### 控制按鈕
- **轉換**：開始轉換程序
- **清除**：重設所有欄位和進度
- **離開**：關閉應用程式（含確認對話方塊）

## 轉換流程

### 單一檔案轉換
1. 點選輸入欄位旁的「瀏覽」
2. 提示時選擇「是」
3. 選擇一個 EPUB 或 PDF 檔案
4. 選擇輸出資料夾
5. 根據需要設定選項
6. 點選「轉換」

### 批次轉換
1. 點選輸入欄位旁的「瀏覽」
2. 提示時選擇「否」
3. 選擇包含 EPUB/PDF 檔案的資料夾
4. 選擇輸出資料夾
5. 根據需要設定選項
6. 點選「轉換」

### 進度監控
- 監控進度條以了解整體完成狀況
- 閱讀狀態訊息以獲得詳細資訊
- 檢查 logs 資料夾中的完整轉換日誌

### 完成處理
- 完成時會顯示成功訊息
- 最終狀態中顯示轉換統計
- 自動儲存日誌檔案供查看

## 進階功能

### 資料夾結構保留
啟用時，維持原始目錄結構：
```
輸入：
└── Books/
    ├── Fiction/
    │   ├── book1.epub
    │   └── book2.pdf
    └── Non-Fiction/
        └── book3.epub

輸出：
└── Converted/
    ├── Fiction/
    │   ├── book1.txt
    │   └── book2.txt
    └── Non-Fiction/
        └── book3.txt
```

### 智慧檔案跳過
- 自動偵測現有輸出檔案
- 比較修改日期
- 跳過不需要重新處理的檔案
- 在最終報告中顯示跳過統計

### 多引擎 PDF 處理
- **主要**：pdfplumber（最佳文字擷取）
- **備援**：PyPDF2（相容性模式）
- 根據檔案特性自動選擇

### 完整日誌記錄
- 即時轉換日誌
- 詳細錯誤報告
- 效能統計
- 儲存至 `logs/` 目錄

## 設定說明

### 設定檔
設定會自動儲存在 `config.json`：

```json
{
    "language": "zh_TW",
    "preserve_structure": true,
    "skip_existing": true,
    "output_encoding": "utf-8",
    "log_level": "INFO",
    "window_geometry": "600x500",
    "last_input_path": "",
    "last_output_path": ""
}
```

### 可自訂設定
- **語言**：介面語言偏好設定
- **結構保留**：預設資料夾結構行為
- **檔案跳過**：預設跳過現有檔案行為
- **視窗幾何**：記憶的視窗大小和位置
- **路徑記憶**：記住最後使用的輸入/輸出路徑

### 手動設定
您可以手動編輯 `config.json` 來自訂：
- **輸出編碼**：變更文字檔編碼
- **日誌等級**：調整日誌詳細程度
- **視窗大小**：設定預設視窗尺寸

## 疑難排解

### 常見問題和解決方案

#### 應用程式無法啟動
**症狀**：啟動時出現錯誤訊息，應用程式當機
**解決方案**：
1. 檢查 Python 版本：`python --version`（需要 3.7+）
2. 重新安裝相依套件：`pip install -r requirements.txt --force-reinstall`
3. 檢查是否缺少系統程式庫
4. 從命令列執行以查看詳細錯誤訊息

#### 無法提取文字
**症狀**：產生空白或極短的 TXT 檔案
**可能原因**：
- PDF 包含影像而非文字（掃描文件）
- EPUB 有 DRM 保護
- 檔案損壞或格式異常
**解決方案**：
1. 檢查轉換日誌以了解具體錯誤
2. 對於掃描文件，請嘗試替代的 PDF 處理軟體
3. 在標準閱讀器中開啟以驗證檔案完整性

#### 轉換速度慢
**症狀**：轉換時間遠超預期
**最佳化**：
1. 啟用「跳過現有檔案」以避免重複處理
2. 關閉其他應用程式以釋放系統資源
3. 使用 SSD 儲存以提升 I/O 效能
4. 對大型收藏進行小批次處理

#### 權限錯誤
**症狀**：「拒絕存取」或「權限被拒」錯誤
**解決方案**：
1. 以系統管理員身分執行應用程式（Windows）
2. 檢查檔案和資料夾權限
3. 確保輸出目錄可寫入
4. 驗證輸入檔案未被其他應用程式鎖定

#### 記憶體問題
**症狀**：處理大檔案或批次時應用程式當機
**解決方案**：
1. 以較小批次處理檔案
2. 關閉其他應用程式以釋放記憶體
3. 在大型轉換作業之間重新啟動應用程式
4. 檢查可用系統記憶體

### 錯誤代碼

| 代碼 | 說明 | 解決方案 |
|------|------|----------|
| E001 | 檔案未找到 | 驗證輸入路徑存在 |
| E002 | 權限被拒 | 檢查檔案權限 |
| E003 | 磁碟空間不足 | 釋放儲存空間 |
| E004 | 不支援的格式 | 使用支援的檔案類型 |
| E005 | 記憶體配置錯誤 | 減少批次大小 |
| E006 | 網路逾時 | 檢查網路連線 |

### 效能最佳化

#### 大批次處理
1. **記憶體管理**：關閉其他應用程式
2. **磁碟 I/O**：使用快速儲存（建議 SSD）
3. **批次大小**：一次處理 50-100 個檔案
4. **系統資源**：監控 CPU 和記憶體使用量

#### 大檔案處理
1. **PDF 檔案**：超過 100MB 的檔案可能需要數分鐘
2. **EPUB 檔案**：複雜版面可能會減慢處理速度
3. **記憶體**：確保大檔案有 2GB+ 可用記憶體
4. **耐心**：某些檔案確實需要較長時間處理

### 取得額外協助

1. **檢查日誌**：查看 `logs/` 目錄中的檔案
2. **文檔**：閱讀 `docs/` 中的完整文檔
3. **GitHub Issues**：回報錯誤或請求功能
4. **社群**：在 GitHub 上參與討論

### 回報問題

回報問題時，請包含：
- 作業系統和版本
- Python 版本（如果從原始碼執行）
- 完整錯誤訊息
- 重現問題的步驟
- 範例檔案（如果可能且不含機密資訊）
- 轉換嘗試的日誌檔案

這些資訊有助於快速診斷和解決問題。
